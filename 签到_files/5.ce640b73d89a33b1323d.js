webpackJsonp([5],{"/DUo":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("Xxa5"),o=n.n(i),a=n("exGp"),c=n.n(a),s=n("Dd8w"),l=n.n(s),r=n("NYxO"),p=(n("mtWM"),n("SFvw")),u=n.n(p),d=(n("xt+v"),{name:"App",data:function(){return{map:null,markerLayer:null,getLocFailCount:0}},props:[],computed:l()({},Object(r.d)(["qywxConfig","locInfo"]),{getSkipState:function(){return!(this.getLocFailCount<3)}}),watch:{},methods:l()({},Object(r.c)(["updateLocInfo"]),{initQywxEnv:function(){var t=this;this.qywxConfig.appId?(wx.config({beta:!0,debug:u.a.debug,appId:this.qywxConfig.appId,timestamp:this.qywxConfig.timestamp,nonceStr:this.qywxConfig.nonceStr,signature:this.qywxConfig.signature,jsApiList:["getLocation","getNetworkType"]}),wx.ready(function(){console.log("企业微信初始化成功"),t.initLocation()}),wx.error(function(t){console.log("企业微信初始化失败"),console.log(t)})):setTimeout(function(){t.initQywxEnv()},1e3)},initLocation:function(){var t=this;this.getLocFailCount++,wx.getLocation({type:"gcj02",success:function(e){console.log("企业微信读到的位置：",e),t.getLocationDesc(e.latitude,e.longitude)},fail:function(e){console.log("企业微信读位置失败：",e),t.showGPSNotice()}})},initMap:function(){var t=new TMap.LatLng(37.802655,112.560843);this.map=new TMap.Map(this.$refs.mapContainer,{center:t,zoom:16,pitch:43.5,rotation:45}),this.markerLayer=new TMap.MultiMarker({map:this.map,styles:{myStyle:new TMap.MarkerStyle({width:25,height:35,src:n("DbcT"),anchor:{x:16,y:32}})},geometries:[{id:"1",styleId:"myStyle",position:new TMap.LatLng(0,0),properties:{title:"marker1"}}]})},getLocationDesc:function(t,e){var n=this;return c()(o.a.mark(function i(){var a,c,s;return o.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:a="E6YBZ-CTPCG-IEYQJ-IF4JD-EOW7J-YKBFB",c="https://apis.map.qq.com/ws/geocoder/v1/",s=t+","+e,n.$jsonp(c,{key:a,callbackName:"QQmap",output:"jsonp",location:s,get_poi:1}).then(function(i){n.$customNotify("成功获取到位置");var o=i.result.pois[0],a=i.result.address_component,c="";c=a.province&&a.city?a.province+" "+a.city+" "+a.district:a.nation+" "+a.ad_level_1+" "+a.ad_level_2;var s=void 0,l=void 0;o?(s=o.title,l=o._distance):(s=i.result.address,l=1e3),console.log(t,e,c,s,l),n.updateLocInfo({lat:t,log:e,area:c,addressCommon:s,distance:l}),n.map.setCenter({lat:t,lng:e}),n.markerLayer.setGeometries([{id:"1",styleId:"myStyle",position:new TMap.LatLng(t,e)}]),n.markerLayer.setGeometries([{id:"1",styleId:"myStyle",position:new TMap.LatLng(t,e)}])}).catch(function(t){console.log(t),n.locInfo.lat||n.showGPSNotice()});case 4:case"end":return i.stop()}},i,n)}))()},signAciton:function(){this.locInfo.lat?this.jumpToReport():this.showGPSNotice()},jumpToReport:function(){var t="";this.locInfo.lat?this.$customNotify("签到成功"):t="noloc=1&";var e=this.$qs.stringify(this.$route.query);this.$router.replace("/report?"+t+e)},showGPSNotice:function(){var t=this;this.$dialog.confirm({title:"温馨提示",confirmButtonText:this.getSkipState?"跳过":"重试",message:"获取位置失败，3次获取失败可跳过，跳过需手动输入实际位置！\n若需重试，请打开定位权限，然后点刷新按钮重新获取位置！"}).then(function(){t.getSkipState?t.jumpToReport():t.initLocation()}).catch(function(){})}}),activated:function(){},mounted:function(){this.initMap(),this.initQywxEnv(),u.a.debug&&this.getLocationDesc(37.710427,112.763593)}}),m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"sign"},[n("div",{ref:"mapContainer",attrs:{id:"map"}}),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"loc"},[t.locInfo.addressCommon?n("h2",[t._v(t._s(t.locInfo.addressCommon))]):t._e(),t._v(" "),t.locInfo.addressCommon?t._e():n("h2",[t._v("正在获取位置...")]),t._v(" "),t.locInfo.lat?n("p",[t._v(t._s(t.locInfo.distance)+"米  "+t._s(t.locInfo.area))]):t._e(),t._v(" "),n("span",{staticClass:"reload",on:{click:t.initLocation}},[t._v("刷新")])]),t._v(" "),n("button",{staticClass:"longBtn",on:{click:t.signAciton}},[t._v(t._s(t.locInfo.lat?"签到":t.getSkipState?"跳过":"重新获取位置"))])])])},staticRenderFns:[]};var g=n("VU/8")(d,m,!1,function(t){n("416/")},"data-v-2c67714c",null);e.default=g.exports},"416/":function(t,e){},DbcT:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAABECAYAAAD3PadxAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkY0NjJFNUY5M0I4NjExRUE5NDNFREE0NzBCMDc1QjBBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkY0NjJFNUZBM0I4NjExRUE5NDNFREE0NzBCMDc1QjBBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RjQ2MkU1RjczQjg2MTFFQTk0M0VEQTQ3MEIwNzVCMEEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RjQ2MkU1RjgzQjg2MTFFQTk0M0VEQTQ3MEIwNzVCMEEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5I3E2KAAAFTElEQVR42uyaa2wVRRTHp6XyqlKs5SEtAQUBsQUTQCGmxlaE+AjEB1Hjg1QjglhIwFgTP/jJjxhDBFETFTVaIZZI1MijEB6KYDUGImLVoFRBwAJKS8PD4v+4/wvjsrt37szeh0lP8ktv7+ye+d/d2Zlzzmxez9rPlaXlgwmgCowDI0EpKGR7O/gNfA++AhvBl6DTprMCi3PKwFzwABgccVwPUAwqwD38rgW8C14Cv6Z6VUztMrAE/ASeSSIyzOScOvpYQp+xCp0B9oAnQHflbt3paw99OwvtBhaDFaBExW8l9L2YfVkJ7QkaQK1Kv9Wyr16pCpVf9z6YpjJn0ld92JUNE7oowyJ1sYtMhU4H81T2bB41RArtA5aBvCwKzaOGoiihz4GBKvs2kFoChfYDc1Tu2GzQP0jonKjpIQvWS79wutCHVO7Zg4nnJSF0LBgeg+NWsJW0xuBPNI3RhVY5OvwDzAQDQCWRzw+zzcWqdaHXOTg6BG4Ab4G/te/l89tsO+jgf4IudKSDo/mgOaK9mcfY2ihdaJmlk4OMfpLZSoerWqYLvcTSydeGqUUn0xEbu1gXahsMn07Tsf4g+5zQ45ZOKtJ0rG5tutBDlk6uSEwfSUymvysdZpVzQn90eCpfBn0j2vsyGrK1H3ShuxwcjQCfgfEBbePZNsLB/y49r9/ENNbWRoMdLDB8w++u5WTtGttu+jdIZaWkkPNcYY4FJe1citvztS8acjB6WkVt/wnzXslBocuC4lEZ9JtzSORmagrMmRYqy2pbzNZJLaHJXRNYmiO3vClZXv+047zqatL3UyYFiA5wFzicBZGH2XeHaUlHltTbwJEMijwKbg9bzqOqeU3MfVoyIFKqzzdxZVOpChXbzfV6fRpFrmcfO6MOMqk4S5g1BdTEkFH6M9ca+k6appiWxs+CNxlTSv1+v4PA/fQxjD7PmpyUZ7l9I8XWqcorD1YbFC/kAdkAPgRrfGm1kRVYXhXp6BMiVsSUu55Rv9hecB/T5WOu46QgpvH2J+PRNl+usyOuAZ2v/ifWJbRLaJfQLqE5aq4TfjeuRIm3H4q1Nvk8S51/C2KvzdLpIlRCslvBZHC98t50CLJSXwp+EmwH68Cn/pworqBEfpBsHCwA12jfH2COIy8I/MzMsZRtciVlA3ao8srb5WCQdu634AXl1f7PxCFUNiLeUF59SewL5W2Rr2VgrZsEvxVakjbG1z6a8ee9YKIWnNckiwuSPUx3gi3sYCudTwIvBog0sd08dxJ9NdL3FvZlJXQKwzaxx8GNHGN+k2C6jrGmHpcO53d1DJL9tp3j/DH+X88+U7r1MialgDoE3K28YpXfpEArrwXdb3BnpPLxHngyJDaVq/kB2McfeMb0ilbxIWgIESk/ZLXy3n0ymYvzeezqkJlmFYUOUSG7iGGdjOLfdRFTVKXFGK1UwZVpxRRF79tI6F/8OyCkXaaiUxZC5ZxfQtoG+fo2ErqB42SW8r0yQfsdPMpJ3NRO8pwDAW1FfKikz42pCG3h3CmT98e+pTFh73ASfy1J6ecIjynnOX4rZh9l7HNfqhN+b85zE5nu1nLpC1vzr+YTW6IVGOS87yLWeHlwXuV5spDcDE7YrEyyD7mcFTbF27KU86PtluFFrAfMpjDF2WWmL4u1WuvlRb/nwVX8/xhFNzK4aGY1Lsj68WpXsFhRrc5voMlc/azydp9jq5TI7b0DPAJuURe+KNNO2rS7Uagu3BLq4LT3OvjINPSzLen01tbrci6Rl4NLKew0BctVbmUsupPjcFvYOExH4HyCt70xUxH+PwIMACmJG9M5KXHPAAAAAElFTkSuQmCC"}});
//# sourceMappingURL=5.ce640b73d89a33b1323d.js.map